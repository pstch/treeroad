{% extends "treeroad/base.html" %}

{% block title %}TreeRoad overview{% endblock %}

{% block content %}
<div class="block">
<h2>Summary</h2>
<p>This is the TreeRoad instance at <b>{{ host }}</b>. I have {{ graphCount }} graph tasks, taking data from {{ rrdFileCount }} .rrd files, {{ serviceCount }} services, {{ nodeCount}} nodes.
</div>

{% if notableNodes %}
<div class="block" id="notableNodes">
<h2>Notable nodes<span class="toggle">+</span><a href="/treeroad/nodes" class="headlink">View all nodes</a></h2>
{% for node in notableNodes %}
<a href="/treeroad/node/{{ node.id }}" class="objectblock">
<h3><b>{{ node.name }}</b>{{ node.services.count }} service{{ node.services.count|pluralize }} 
{% if node.highlight %}
<i>HL</i>
{% endif %}
</h3>
<p>{{ node.description }}
<br/><i>(path part: <b>{{ node.pathPart }})</b></i></p>
</a>
{% endfor %}
</ul>
</div>
<script>
$("body").ready(function () {
  $("div#notableNodes.block > a").slideUp(0)
});
$("div#notableNodes.block > h2 > span.toggle").click(function() {
  $("div#notableNodes.block > a").slideToggle()
});
</script>
{% endif %}

{% if notableServices %}
<div class="block" id="notableServices">
<h2>Notable services<span class="toggle">+</span><a href="/treeroad/services" class="headlink">View all services</a></h2>
{% for service in notableServices %}
<a href="/treeroad/service/{{ service.id }}" class="objectblock">
<h3><b>{{ service.name }}</b><i>{{ service.node }}</i> {{ service.graphs.count }} graph{{ service.graphs.count|pluralize }} 
{% if service.highlight %}
<i>HL</i>
{% endif %}
</h3>
<p>{{ service.description }}
<br/><i>(path part: <b>{{ service.pathPart }})</b></i></p>
{% if service.graphs.all|length == 0 %}
<p>No graphs.</p>
{% else %}
{% if service.graphs.all|length > 1 %}
<p>More than one graph.</p>
{% else %}
{% with service.graphs.all|first as first_graph %}
{% if first_graph.drawThumbnail %}
<img src="/media/graphs/{{ first_graph.thumbPath }}" />
{% endif %}
{% endwith %}
{% endif %}
{% endif %}
</a>
{% endfor %}
</div>
<script>
$("body").ready(function () {
	  $("div#notableServices.block > a").slideUp(0)
	});
$("div#notableServices.block > h2 > span.toggle").click(function() {
  $("div#notableServices.block > a").slideToggle()
});
</script>
{% endif %}

{% if notableGraphs %}
<div class="block" id="notableGraphs">
<h2>Notable graphs<span class="toggle">+</span><a href="/treeroad/graphs" class="headlink">View all graphs</a></h2>
{% for graph in notableGraphs %}
<a href="/treeroad/graph/{{ graph.id }}" class="objectblock">
<h3><b>{{ graph.name }}</b><i> {{ graph.service.node }}/{{ graph.service }}</i> {{ graph.defs.count }} definition{{ graph.defs.count|pluralize }} 
{% if graph.highlight %}
<i>HL</i>
{% endif %}
</h3>
<p>
<b>Start:</b> {{ graph.start }} &nbsp;
<b>End:</b> {{ graph.end }} &nbsp;
<b>Size:</b> {{ graph.width }}x{{ graph.height }} <br/>
{{ graph.description }}<br/>
{% if graph.drawThumbnail %}
<img src="/media/graphs/{{ graph.thumbPath }}" />
{% endif %}
</p>
</a>
{% endfor %}
</div>
<script>
$("body").ready(function () {
	  $("div#notableGraphs.block > a").slideUp(0)
	});
$("div#notableGraphs.block > h2 > span.toggle").click(function() {
  $("div#notableGraphs.block > a").slideToggle()
});
</script>
{% endif %}

{% endblock %}